<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Prediction Report #{{ record.id }}</title>
    <style>
        @page {
            margin: 2cm;
        }
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            color: #333;
        }
        .header {
            text-align: center;
            border-bottom: 3px solid #3A1C71;
            padding-bottom: 20px;
            margin-bottom: 30px;
        }
        .header h1 {
            color: #3A1C71;
            margin: 0;
        }
        .section {
            margin-bottom: 30px;
        }
        .section h2 {
            color: #3A1C71;
            border-bottom: 2px solid #D76D77;
            padding-bottom: 5px;
        }
        .result-box {
            background: #f8f9fa;
            border-left: 5px solid #3A1C71;
            padding: 15px;
            margin: 20px 0;
        }
        .result-box .prediction {
            font-size: 24px;
            font-weight: bold;
            color: #3A1C71;
        }
        .result-box .probability {
            font-size: 20px;
            color: #D76D77;
        }
        .input-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 10px;
        }
        .input-table th, .input-table td {
            border: 1px solid #ddd;
            padding: 10px;
            text-align: left;
        }
        .input-table th {
            background-color: #3A1C71;
            color: white;
        }
        .input-table tr:nth-child(even) {
            background-color: #f9f9f9;
        }
        .footer {
            margin-top: 50px;
            padding-top: 20px;
            border-top: 2px solid #ddd;
            text-align: center;
            font-size: 12px;
            color: #666;
        }
        .disclaimer {
            background: #fff3cd;
            border: 1px solid #ffc107;
            padding: 15px;
            margin-top: 20px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <div class="header">
        <h1>AI Disease Prediction Report</h1>
        <p>Report ID: #{{ record.id }}</p>
        <p>Generated: {{ record.created_at|date:"F d, Y \a\t H:i" }} UTC</p>
    </div>

    <div class="section">
        <h2>Prediction Summary</h2>
        <div class="result-box">
            <p><strong>Disease Type:</strong> {{ record.disease|title }}</p>
            <p class="prediction">Result: {{ record.prediction_label }}</p>
            <p class="probability">Confidence: {{ probability_percent }}%</p>
        </div>
    </div>

    {% if record.probabilities %}
    <div class="section">
        <h2>Probability Distribution</h2>
        <table class="input-table">
            <thead>
                <tr>
                    <th>Classification</th>
                    <th>Probability</th>
                </tr>
            </thead>
            <tbody>
                {% for label, prob in record.probabilities.items %}
                <tr>
                    <td>{{ label }}</td>
                    <td>{{ prob|floatformat:4 }} ({{ prob|floatformat:4|slice:"2:" }}00%)</td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
    {% endif %}

    <div class="section">
        <h2>Input Parameters</h2>
        <table class="input-table">
            <thead>
                <tr>
                    <th>Parameter</th>
                    <th>Value</th>
                </tr>
            </thead>
            <tbody>
                {% for key, value in record.inputs.items %}
                <tr>
                    <td>{{ key|title }}</td>
                    <td>
                        {% if value|floatformat:2 %}
                            {{ value|floatformat:2 }}
                        {% else %}
                            {{ value }}
                        {% endif %}
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="disclaimer">
        <h3>Medical Disclaimer</h3>
        <p>
            <strong>This prediction is for educational and research purposes only.</strong>
            It is generated by a machine learning model and should NOT be used as a substitute 
            for professional medical advice, diagnosis, or treatment. Always seek the advice of 
            qualified healthcare providers with any questions regarding medical conditions.
        </p>
        <p>
            The predictions are based on statistical models trained on historical datasets and 
            may not reflect individual patient circumstances. Clinical decisions should be made 
            by licensed healthcare professionals using comprehensive patient evaluation.
        </p>
    </div>

    <div class="footer">
        <p>&copy; 2025 AI Disease Prediction System</p>
        <p>This report was automatically generated by the AI Disease Prediction System.</p>
    </div>
</body>
</html>
